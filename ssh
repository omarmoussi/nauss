Mysql server preparation:
Installation mysql-server:
apt update
apt install mysql-server
Allow remote access to MySQL:
nano /etc/mysql/mysql.conf.d/mysqld.cnf
     Change line
      bind-address = 127.0.0.1  to #bind-address = 127.0.0.1 
Restart MySQL service:
service mysql restart
Create remote mysql user:
CREATE USER 'sabaya'@'10.164.0.3' IDENTIFIED BY 'password';
GRANT ALL ON *.* TO 'sabaya'@'10.164.0.3';
FLUSH PRIVILEGES;
Laravel server preparation:
Install php:
apt-get install software-properties-common -y
add-apt-repository ppa:ondrej/php
apt-get install -y php8.3-common php8.3-gmp php8.3-curl php8.3-soap php8.3-bcmath php8.3-intl php8.3-mbstring php8.3-xmlrpc php8.3-mysql php8.3-gd php8.3-xml php8.3-cli php8.3-zip php8.3-fpm
Install redis:
apt-get install -y redis
Install Composer
curl -sS https://getcomposer.org/installer -o composer-setup.php
sudo php composer-setup.php --install-dir=/usr/local/bin --filename=composer


Project deployment:
code source path: /var/www/html/sabayabackend
 update env file and runcommande;

composer update
php artisan clear-compiled
php artisan migrate --force
sudo php artisan cache:clear
php artisan route:clear
php artisan view:clear
php artisan config:clear
php artisan config:cache
update permission




######
rm -f /etc/apt/sources.list.d/ondrej-php.list
rm -f /usr/share/keyrings/ondrej-php.gpg

curl -fsSL "https://keyserver.ubuntu.com/pks/lookup?op=get&search=0x4F4EA0AAE5267A6C" \
| gpg --dearmor \
| sudo tee /usr/share/keyrings/ondrej-php.gpg > /dev/null

ls -l /usr/share/keyrings/ondrej-php.gpg


CODENAME=$(lsb_release -sc)

echo "deb [signed-by=/usr/share/keyrings/ondrej-php.gpg] \
https://ppa.launchpadcontent.net/ondrej/php/ubuntu \
$CODENAME main" \
| sudo tee /etc/apt/sources.list.d/ondrej-php.list


sudo apt update


sudo chown -R www-data:www-data /var/www/html/sabayabackend
sudo find  /var/www/html/sabayabackend -type f -exec chmod 664 {} \;   
sudo find  /var/www/html/sabayabackend -type d -exec chmod 775 {} \;
sudo chmod -R ug+rwx storage bootstrap/cache



curl -fsSL https://nginx.org/keys/nginx_signing.key | sudo gpg --dearmor -o /usr/share/keyrings/nginx-archive-keyring.gpg
echo "deb [signed-by=/usr/share/keyrings/nginx-archive-keyring.gpg] http://nginx.org/packages/ubuntu $(lsb_release -cs) nginx" | sudo tee /etc/apt/sources.list.d/nginx.list
sudo apt update
sudo apt install -y nginx
